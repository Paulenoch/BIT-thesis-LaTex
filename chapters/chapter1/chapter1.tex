\chapter{绪论}

\section{研究背景与应用场景}

四旋翼无人机凭借高机动性、垂直起降与悬停能力，
 在巡检、搜索救援、环境监测、应急通信以及室内外自主作业等任务中具有广泛应用前景\cite{Liu2020QuadControl}。
 如图~\ref{fig:scenario}所示，
 典型应用场景涵盖城市建筑巡检、林区搜索与穿越、室内仓储与走廊导航等，
 这些场景的共同特征是障碍密度高、环境结构多变、且往往缺乏预先地图信息。

\begin{figure}[htbp]
\centering
\includegraphics[width=0.92\textwidth]{pictures/图1.1.png}
\caption{四旋翼无人机高速避障的典型应用场景与共性挑战}
\label{fig:scenario}
\end{figure}

当飞行任务从"低速、开阔、静态"逐步走向"高速、密集、动态"的复杂场景时，
 自主飞行面临的核心矛盾会显著加剧： 一方面，
高速场景会放大传感噪声、执行延迟与建模误差在闭环控制中的累积效应；
 另一方面，
密集障碍环境要求系统在极短时间内完成感知、决策与控制，
并在强不确定性下保持鲁棒性。

\subsection{高速闭环的延迟预算分析}

对于自主避障系统而言，
 从传感器采集原始数据到执行器完成控制指令的全链路延迟决定了系统的"反应窗口"。
 该延迟可以分解为四个主要环节： 传感采集延迟$\tau_{\text{sensor}}$、数据传输与预处理延迟$\tau_{\text{preprocess}}$、 策略推理延迟$\tau_{\text{inference}}$以及低层控制器的执行延迟$\tau_{\text{actuator}}$。
 表~\ref{tab:latency_budget}给出了典型端到端系统的延迟范围。

\begin{table}[htbp]
\centering
\caption{端到端避障系统延迟预算分解}
\label{tab:latency_budget}
\zihao{5}
\begin{tabular}{lccl}
\toprule
\textbf{环节} & \textbf{符号} & \textbf{典型范围 (ms)} & \textbf{说明} \\
\midrule
传感器采集 & $\tau_{\text{sensor}}$ & 5--15 & 深度相机帧间隔（30--60 FPS） \\
数据预处理 & $\tau_{\text{preprocess}}$ & 1--5 & 图像缩放、归一化、拷贝到GPU \\
策略推理 & $\tau_{\text{inference}}$ & 5--30 & 视觉编码 + 时序聚合 + 控制头 \\
低层控制 & $\tau_{\text{actuator}}$ & 2--10 & 姿态环 + 电机混控 + 执行器响应 \\
\midrule
\textbf{全链路延迟} & $\tau_{\text{total}}$ & \textbf{13--60} & $\sum \tau_i$ \\
\bottomrule
\end{tabular}
\end{table}

全链路延迟的物理后果直接取决于飞行速度：以 \SI{10}{m/s} 的速度飞行时，
 \SI{50}{ms} 的延迟将产生 \SI{0.5}{m} 的“决策盲区”，
 导致系统在此距离内只能基于滞后的状态信息执行控制。
 当速度提升至 \SI{12}{m/s} 的极限工况时，
 该盲区扩大至 \SI{0.6}{m}。
 考虑到密集环境下的障碍间距通常仅为 \SI{1}{m}--\SI{3}{m}，
 这一盲区已严重压缩了有效的安全冗余。
 因此，
降低推理延迟是确保高速飞行安全性的先决条件，
 这也构成了本文采用轻量化架构与线性复杂度时序模型的根本动机。
 \subsection{高速下的误差放大机制}

高速飞行场景中，
多种误差来源经由闭环耦合形成正反馈放大链路。
 如图~\ref{fig:error_amplify}所示，
 单帧观测噪声（深度噪声、运动模糊、遮挡）导致策略在当前时间步产生偏差$\epsilon_t$；
 该偏差使无人机偏离预期状态，
 导致下一时间步的观测质量进一步退化（因视角改变、无人机距离障碍物更近时深度估计误差会增加），
 从而诱发更严重的决策偏差$\epsilon_{t+1}$。
 在高速场景下，
每一时间步的“感知-决策”窗口更短，
纠正能力更弱，
误差累积速度因此显著加快。

\begin{figure}[htbp]
\centering
\begin{tikzpicture}[
  >=Stealth,
  block/.style={draw, rounded corners=3pt, minimum width=2.8cm, minimum height=0.9cm, align=center, font=\small, fill=#1},
  arrow/.style={->, thick, color=black!70},
]
% 误差来源
\node[block=blue!10] (noise) at (0, 0) {观测噪声\\(深度噪声/模糊/遮挡)};
\node[block=orange!10] (decision) at (5, 0) {策略偏差 $\epsilon_t$\\(决策误差)};
\node[block=red!8] (state) at (10, 0) {状态偏移\\(位置/姿态偏离)};
\node[block=red!15] (worse) at (10, -2) {观测质量退化\\(视角变化/更近障碍)};
\node[block=orange!15] (next) at (5, -2) {更大偏差 $\epsilon_{t+1}$};
\node[block=blue!15] (accum) at (0, -2) {误差累积\\碰撞风险 $\uparrow$};

\draw[arrow] (noise) -- (decision);
\draw[arrow] (decision) -- (state);
\draw[arrow] (state) -- (worse);
\draw[arrow] (worse) -- (next);
\draw[arrow] (next) -- (accum);
\draw[arrow, dashed, red!60] (accum) -- node[left, font=\scriptsize, color=red!60] {正反馈} (noise);

\node[draw, rounded corners=2pt, fill=yellow!10, font=\scriptsize, inner sep=3pt] at (5, -3.5) {高速放大因子：时间窗口压缩 $\rightarrow$ 纠正能力下降 $\rightarrow$ 累积加速};
\end{tikzpicture}
\caption{高速闭环控制中的误差放大链路}
\label{fig:error_amplify}
\end{figure}

图~\ref{fig:error_flight}进一步以飞行轨迹视角直观展示了这一误差放大与累积过程： 深度噪声与运动模糊导致策略偏离理想轨迹，
偏差随时间步持续放大，
最终导致碰撞风险急剧上升。

\begin{figure}[htbp]
\centering
\includegraphics[width=0.88\textwidth]{pictures/误差累积导致偏移.png}
\caption{高速飞行中的误差放大与累积示意：深度噪声与运动模糊导致实际轨迹偏离理想轨迹，误差随时间步持续放大}
\label{fig:error_flight}
\end{figure}

无人机闭环控制飞行中，
 在$\SI{3}{m/s}$低速下，
 策略有$\SI{300}{ms}$的反应时间来纠正$\SI{1}{m}$距离内的偏差；
 而在$\SI{12}{m/s}$下，
 同样的距离仅留下$\SI{83}{ms}$——不到低速的三分之一。
 这要求策略不仅要迅速识别输入的观测，
 还要能够利用历史信息进行时序平滑，
抑制噪声导致的瞬时偏差。

\subsection{端到端范式需要时序建模的直觉}

上述误差放大机制揭示了一个核心洞察： 单帧决策在高速场景下具有固有的脆弱性。
 单帧深度信息面临以下时空局限性与噪声干扰：

\begin{itemize}
  \item 运动模糊（Motion Blur）：高速运动导致相机在曝光时间内产生显著的位移偏差，
    造成深度图像边缘退化与语义模糊。
     \item 测量噪声与量化误差：深度传感器在远距离（$>\SI{5}{m}$）或近场盲区内的测量精度显著恶化，
    数据可靠性随距离增加而降低。
     \item 瞬时几何遮挡：复杂的动态环境或障碍物拓扑结构，
    常导致关键避障区域在特定视角下发生临时性遮挡。
     \item 细小障碍物湮没：受限于传感器输入图像的较低分辨率，
    树干、电线等细长物体仅占据极少数像素点，
    在单帧检测中极易被噪声淹没或忽略。
     \end{itemize}

时序聚合（Temporal Aggregation）为上述感知的脆弱性提供了天然的缓解机制。
 通过引入短时历史观测（如最近 $10$--$20$ 帧），
决策策略得以实现以下功能：

\begin{itemize}
  \item 时域去噪与特征增强：通过多帧关联有效抑制传感器的随机测量噪声，
    提升深度特征的信噪比；
     \item 时空一致性推断：利用运动先验补偿瞬时遮挡，
    基于历史轨迹推断障碍物的潜在演化位置；
     \item 动力学平滑约束：在特征层面整合时序上下文，
    产生更平滑的控制律输出，
    显著降低高速状态下的指令震荡。
     \end{itemize}

这正是本文选择线性复杂度序列模型（如 Mamba）作为核心时序建模组件，
以构建鲁棒特征表征的根本动机。

在机器人与无人机自主飞行领域，
 主流方案长期采用模块化范式（Perception--Planning--Control），
 通过视觉/视觉惯性里程计、SLAM\cite{MurArtal2017ORBSLAM2,Qin2018VINSMONO,Campos2021ORBSLAM3}、 地图构建、局部/全局规划\cite{Karaman2011SamplingOptimal,Zhou2019FastPlanner}和低层控制器来实现闭环导航。
 该范式的优势在于工程可解释性强、模块边界清晰、便于调参与验证。
 然而，
模块化方案的潜在代价是：系统延迟随模块串联累积（表~\ref{tab:latency_budget}中各环节在模块化方案中更为突出）、 误差跨模块传播、以及模块间假设不一致。
 Loquercio等\cite{Loquercio2021HighSpeedWild}明确指出： 传统模块化做法在高速密集环境中会因流水线式延迟与误差传递而变得脆弱。

端到端学习控制通过将高维观测直接映射为动作指令或速度矢量，
 避免显式建图与复杂规划带来的计算与时延瓶颈。
 如图~\ref{fig:modular_vs_e2e}所示，
 端到端方法将感知到控制的全链路压缩为单次神经网络前向推理，
 显著简化了系统架构。
 端到端控制的思想可追溯到Pomerleau提出的ALVINN\cite{Pomerleau1989ALVINN}；
 NVIDIA 的端到端自动驾驶系统 \cite{Bojarski2016EndToEndNVIDIA} 验证了深度卷积神经网络（CNN）从原始图像直接映射至底层控制量的可行性。
 在无人机领域，
 DroNet\cite{Loquercio2018DroNet}、CAD2RL\cite{Sadeghi2017CAD2RL}以及Deep Drone Racing\cite{Kaufmann2018DeepDroneRacing}等工作逐步推进了端到端范式的应用。
 近年来，
Kaufmann等提出的Swift系统\cite{Kaufmann2023SwiftNature}在真实对抗竞速中达到了超越人类冠军的水平，
 代表了端到端方法的里程碑式进展。
 Levine等\cite{Levine2016E2ERobotLearning}从更广泛的机器人操作视角验证了端到端策略的有效性；
 Chen等\cite{Chen2020LearningByCheat}提出的"Learning by Cheating"范式将特权信息蒸馏系统化。

\begin{figure}[htbp]
\centering
\includegraphics[width=0.92\textwidth]{pictures/模块化VS端到端.png}
\caption{模块化导航范式与端到端控制范式的对比：左侧为传统模块化流水线（Sensor$\rightarrow$SLAM$\rightarrow$Mapping$\rightarrow$Planning$\rightarrow$Low-Level Control），延迟逐级累积；右侧为端到端学习控制，传感器输出经神经网络直接映射为控制指令，显著降低延迟}
\label{fig:modular_vs_e2e}
\end{figure}

在端到端视觉避障的最新进展中，
 Bhattacharya等\cite{Bhattacharya2025ViTFly}首次将视觉Transformer（ViT）引入四旋翼端到端避障控制，
发表于ICRA 2025。
 该工作系统对比了ConvNet、LSTMnet、UNet+LSTM、ViT与ViT+LSTM五种约3M参数的端到端架构，
 在Flightmare仿真平台的Spheres/Trees双环境中评测3--7m/s的避障性能。
 核心发现包括： （1）ViT+LSTM在5m/s以上的高速段碰撞率低于所有其他模型，
 甚至在6m/s以上超越特权信息专家策略；
 （2）基于注意力的模型（ViT、ViT+LSTM）在从未见过的Trees环境中泛化能力远优于CNN和UNet方案；
 （3）ViT+LSTM在保持低碰撞率的同时还具有最低的能量消耗。
 该工作还完成了7m/s的零样本Sim-to-Real迁移验证。
 Bhattacharya等的工作确立了ViT作为端到端避障视觉编码器的有效性，
 并证明注意力机制与循环模块（LSTM）的结合对高速闭环控制至关重要。

本文的研究基点建立在 Bhattacharya 等人提出的 ViT+LSTM 框架之上。
 在继承其 ViT 视觉编码器、 特权专家策略（Privileged Expert Policy）、 行为克隆（Behavior Cloning）训练范式及 Flightmare 仿真平台的基础上，
 本文将核心时序聚合模块由传统的 LSTM 升级为具有线性复杂度的选择性状态空间模型 Mamba \cite{Gu2023Mamba}。
 此外，
本文将评估速度区间从 \SIrange{3}{7}{m/s} 大幅扩展至 \SIrange{3}{12}{m/s}，
 这一测试范畴显著超越了基线工作的边界。
 通过引入 DAgger 闭环数据增强与 RACS 部署侧平滑约束等系统性改进，
 本文旨在探讨一个核心命题：在极具竞争力的端到端基准之上，
采用更先进的时序建模范式（SSM/Mamba）能否实现性能的进一步突破？

总结而言，
高速端到端视觉避障的价值不仅在于"替代模块化"，
 更在于以更短时延、更强时序建模能力支撑闭环稳定性。
 而当系统部署在流式推理（Streaming Inference）的在线控制回路中时，
 "时间建模+状态一致性+工程可复现"会成为决定性能上限的关键因素。


\section{问题定义}

\subsection{输入-输出接口}

本文研究的核心问题可定义为： 在未知障碍环境下，
四旋翼无人机以给定目标速度完成穿越/到达任务，
 同时最小化碰撞、保持控制平滑。
 具体地，
端到端视觉避障任务的输入--输出接口定义如下：

\begin{itemize}
  \item 输入：前视单目深度图像$D_t \in \mathbb{R}^{H \times W}$与本体状态（姿态四元数$q_t$、归一化目标速度$\tilde{v}^{\text{target}}$）。
     \item 输出：世界坐标系下的三维速度指令$\mathbf{v}_t = [v^x_t, v^y_t, v^z_t] \in \mathbb{R}^3$。
     \item 任务目标：在密集障碍环境中完成沿主飞行方向的穿越，
    最小化碰撞接触，
    保证控制指令的平滑性。
     \end{itemize}

该任务的闭环控制流程如图~\ref{fig:task_loop}所示： 在每个控制周期，
 策略$\pi_\theta$根据观测$o_t = (D_t, s_t)$输出速度指令$\mathbf{v}_t$，
 经由低层控制器转化为电机指令并执行，
 仿真器/飞行器更新状态后返回下一帧观测，
 形成闭环。

\begin{figure}[htbp]
\centering
\begin{tikzpicture}[
  >=Stealth,
  node distance=1.2cm and 1.5cm,
  block/.style={draw, rounded corners=3pt, minimum width=2.5cm, minimum height=1.0cm, align=center, font=\small},
  arrow/.style={->, thick, color=black!70},
]
\node[block, fill=blue!10] (obs) {观测 $o_t$\\$(D_t, s_t)$};
\node[block, fill=orange!15, right=of obs] (policy) {策略 $\pi_\theta$\\(ViT+Mamba)};
\node[block, fill=red!8, right=of policy] (cmd) {速度指令\\$\mathbf{v}_t$};
\node[block, fill=green!10, below=1.0cm of cmd] (ctrl) {低层控制器\\+ 执行器};
\node[block, fill=green!10, below=1.0cm of obs] (env) {仿真器/\\飞行器};

\draw[arrow] (obs) -- (policy);
\draw[arrow] (policy) -- (cmd);
\draw[arrow] (cmd) -- (ctrl);
\draw[arrow] (ctrl) -- (env);
\draw[arrow] (env) -- node[left, font=\scriptsize] {状态更新} (obs);
\end{tikzpicture}
\caption{端到端视觉避障任务闭环控制流程}
\label{fig:task_loop}
\end{figure}

\subsection{部分可观测性与序列建模的必要性}

值得注意的是，
 上述任务实质上是一个部分可观测（POMDP）问题，
 而非标准MDP。
 原因在于：（1）单帧深度图像$D_t$仅提供前方有限视场（水平约$90^\circ$）的深度信息，
侧方与后方完全不可观测；
 （2）深度图像受噪声与量化误差影响，
无法精确重建三维障碍分布；
 （3）仅凭单帧深度图无法区分静态障碍与动态物体，
也无法推断障碍的运动趋势。
 此外，
本体状态（姿态四元数 $q_t$ 与归一化目标速度 $\tilde{v}^{\text{target}}$）仅提供局部运动约束，
 无法全面描述环境动态与障碍分布。

在POMDP框架下，
 单步观测$o_t$不足以确定环境的完整状态$s_t^{\text{env}}$。
 经典的POMDP理论\cite{Elman1990RNN}指出，
 当观测不完整时，
策略需要利用历史观测序列来推断隐含状态信息：
\begin{equation}
  a_t = \pi_\theta(o_{\le t}) = \pi_\theta(o_1, o_2, \ldots, o_t)
\end{equation}

这在理论层面为引入序列模型（如 LSTM 或 Mamba）作为时序聚合模块提供了直接动机： 序列模型的隐状态 $\mathbf{h}_t$ 可被视为对历史观测序列的非线性压缩，
 从而在隐式层面逼近部分观测环境下的信念状态（Belief State）。
 在高速避障场景中，
 这种时序记忆机制至关重要——它使策略能够在当前帧观测受损或不可靠时，
 从历史轨迹中提取时空上下文信息，
 从而做出更具鲁棒性的决策。


\section{关键挑战}

结合已有研究与工程实践，
本文将高速端到端视觉避障的关键挑战归纳为以下三条，
它们与本文三项创新点一一对应。

\subsection{挑战一：时序建模与高速决策}

高速避障并非静态映射问题：策略必须利用短时历史信息来抑制观测噪声、捕捉障碍相对运动趋势并稳定控制输出。
单帧决策在高速飞行中尤为脆弱——运动模糊、深度噪声与遮挡等因素使单帧信息可靠性大幅降低（如1.1.3节所述）。
传统做法多使用LSTM/RNN\cite{Hochreiter1997LSTM}进行时序聚合，
但面临长序列训练稳定性与计算瓶颈等问题。
结构化状态空间模型（SSM），
特别是Mamba\cite{Gu2023Mamba}，
以线性复杂度实现高效时序建模，
为高速闭环控制提供了新的可能。

同时，
行为克隆（BC）训练范式存在固有的闭环分布偏移问题\cite{Ross2011DAgger}：训练数据来自专家策略诱导的状态分布，
而部署时学生策略自身会偏离该分布，
导致误差累积。
Ross等\cite{Ross2011DAgger}的理论分析表明，
BC的期望代价上界与时间步$T$呈$O(T^2)$增长。
在高速场景下，
这一偏移的后果从"性能下降"加剧为"碰撞风险"。
如何设计有效的时序建模架构并缓解分布偏移，
是本文的第一个研究重点，
对应第3章的创新点一。

本文验证的命题1：在相同视觉编码器（ViT）条件下，
Mamba时序模块在高速段（$\ge \SI{9}{m/s}$）的碰撞指标显著优于LSTM；
DAgger闭环数据增强在BC基线之上进一步降低碰撞频次并收敛跨试验方差。

\subsection{挑战二：流式部署一致性}

序列模型在训练时以定长序列Batch前向计算，
而在部署时以逐步Streaming递推运行。
如图~\ref{fig:batch_vs_stream}所示，
两种模式在状态管理上存在本质差异。
若内部状态在错误时刻被重置（例如每次推理调用时重新初始化），
序列模型将退化为"无记忆策略"，
完全丧失时序聚合能力。
这类问题往往不易在离线评测中暴露（因为离线评测中通常以Batch模式运行，
状态天然正确），
但会在实际闭环部署中引发毁灭性后果。

更深层的原因在于：现有端到端控制文献中，
对训练--推理模式差异的讨论非常有限。
多数工作隐式假设"训练时的模型行为与部署时一致"，
但当部署工程实现引入了错误的状态管理逻辑时，
这一假设会被悄无声息地破坏——且离线指标不会反映问题。

\begin{figure}[htbp]
\centering
\begin{tikzpicture}[
  >=Stealth,
  frame/.style={draw, minimum width=0.7cm, minimum height=0.7cm, font=\scriptsize, inner sep=1pt},
  state/.style={draw, circle, minimum size=0.5cm, font=\scriptsize, inner sep=0pt},
]
% Batch模式
\node[font=\small\bfseries, color=blue!70] at (-2.2, 1.8) {训练：Batch模式};
\foreach \i in {1,...,8} {
  \node[frame, fill=blue!10] (b\i) at (\i*0.9, 1.8) {$x_{\i}$};
}
\draw[decorate, decoration={brace, amplitude=5pt, mirror}, thick, blue!60] (b1.south west) -- (b8.south east) node[midway, below=6pt, font=\scriptsize, color=blue!60] {一次性并行计算所有输出};
\node[state, fill=blue!20] (h0b) at (0.2, 1.8) {$h_0$};
\draw[->, blue!50, thick] (h0b) -- (b1);

% Streaming模式（正确）
\node[font=\small\bfseries, color=green!60!black] at (-2.2, 0.4) {部署：Streaming};
\foreach \i in {1,...,8} {
  \node[frame, fill=green!10] (s\i) at (\i*0.9, 0.4) {$x_{\i}$};
}
\foreach \i [evaluate=\i as \j using int(\i+1)] in {1,...,7} {
  \draw[->, green!50!black, thick] (s\i) -- (s\j);
}
\node[state, fill=green!20] (h0s) at (0.2, 0.4) {$h_0$};
\draw[->, green!50!black, thick] (h0s) -- (s1);
\node[font=\scriptsize, color=green!60!black] at (5.5, -0.15) {状态跨步连续传播 $\checkmark$};

% 错误模式
\node[font=\small\bfseries, color=red!70] at (-2.2, -1.0) {错误：逐步重置};
\foreach \i in {1,...,8} {
  \node[frame, fill=red!10] (r\i) at (\i*0.9, -1.0) {$x_{\i}$};
  \node[state, fill=red!20, above=0.15cm of r\i, font=\tiny] (hr\i) {$0$};
  \draw[->, red!50, thin] (hr\i) -- (r\i);
}
\node[font=\scriptsize, color=red!70] at (5.5, -1.65) {每步重置 $\rightarrow$ 无记忆退化 $\times$};
\end{tikzpicture}
\caption{训练Batch模式与部署Streaming模式的状态管理差异，以及错误的逐步重置导致的无记忆退化}
\label{fig:batch_vs_stream}
\end{figure}

本文验证的命题2：错误的逐步状态重置会导致碰撞率从$0\%$飙升至$90\%$以上；
通过等价性单元测试可以在部署前检测此类错误。

\subsection{挑战三：算力约束与高效视觉骨干}

端到端策略在真实系统中落地，
通常受限于机载算力与控制周期的实时性约束。
表~\ref{tab:latency_budget}显示，
策略推理在全链路延迟中占比最大（$\SI{5}{ms}$--$\SI{30}{ms}$），
因此视觉编码器的效率直接决定控制频率。
基于自注意力的ViT\cite{Dosovitskiy2020ViT}在表征能力上具有优势，
但其$O(n^2)$复杂度在高分辨率输入下可能成为推理瓶颈。
如图~\ref{fig:complexity_compare}所示，
基于SSM的架构以$O(n)$线性复杂度提供了更具部署友好性的替代方案。

在本文中，
第3章已验证Mamba在时序维度的聚合优势——同等条件下Mamba显著优于LSTM。
一个自然的后续研究问题是：能否将SSM范式从时序维度进一步扩展到空间编码，
形成空间--时间统一的全SSM架构？
然而，
纯Mamba处理视觉任务面临固有局限：图像像素不具备文本token那样的自然序列依赖，
自回归建模每步只沿一个方向扫描，
无法在单次前向传播中获取全局空间上下文\cite{Zhu2024VisionMamba}。
Vision Mamba（Vim）\cite{Zhu2024VisionMamba}尝试通过双向SSM缓解这一问题，
但引入了显著的推理延迟，
且在ImageNet上的精度仍远低于同规模ViT（Vim-T仅76.1\%）。
VMamba\cite{Liu2024VMamba}提出四方向交叉扫描（Cross-Scan）以整合周围token信息，
但其感受野仍受扫描路径约束，
且吞吐量较低。

MambaVision\cite{Hatamizadeh2025MambaVisionCVPR}提供了一条更具工程可行性的路线：采用分层混合架构，
在浅层阶段使用CNN残差块进行高分辨率快速特征提取，
在深层阶段交替使用重新设计的MambaVision Mixer（含SSM分支与对称非SSM分支的双路拼接）和自注意力块。
通过系统消融验证，
在最后$N/2$层放置自注意力块能够有效恢复SSM序列约束所丢失的全局空间依赖。
在ImageNet-1K上，
MambaVision-T以31.8M参数达到82.3\% Top-1精度与6298 img/s吞吐量（A100），
在精度--吞吐Pareto前沿上显著优于Vim、VMamba与同尺寸ViT变体\cite{Hatamizadeh2025MambaVisionCVPR}。
这一架构使"将空间编码器从ViT替换为SSM-based方案"成为可探索的选项。

\begin{figure}[htbp]
\centering
\begin{tikzpicture}
\begin{axis}[
  width=8cm, height=5cm,
  xlabel={序列/Token长度 $n$},
  ylabel={计算复杂度（示意）},
  xmin=0, xmax=10,
  ymin=0, ymax=100,
  xtick=\empty,
  ytick=\empty,
  legend pos=north west,
  legend style={font=\small},
  grid=major,
  grid style={gray!20},
]
\addplot[domain=0:10, samples=50, thick, color=red!70, dashed] {x^2};
\addlegendentry{Self-Attention $O(n^2)$}
\addplot[domain=0:10, samples=50, thick, color=blue!70] {x*3};
\addlegendentry{SSM/Mamba $O(n)$}
\end{axis}
\end{tikzpicture}
\caption{自注意力机制$O(n^2)$与SSM线性$O(n)$复杂度的对比示意}
\label{fig:complexity_compare}
\end{figure}

本文验证的命题3：在固定时序模块与训练流程的条件下，
替换视觉编码器为MambaVision能够带来推理延迟或显存收益，
且不显著牺牲安全性（第5章验证）。


\section{本文贡献}

结合上述三项关键挑战，
本文形成如下三项主要贡献与创新点：

\begin{enumerate}

  \item 提出面向高速端到端避障的ViT+Mamba时序策略网络，
    构建BC+DAgger+RACS的完整训练--部署系统。
     构建以ViT空间编码、Mamba选择性状态空间模型时序聚合与线性控制头为核心的端到端策略网络。
    训练方面采用行为克隆（BC）建立强基线，
    并引入DAgger闭环数据增强缓解分布偏移；
    部署方面设计RACS动态速率限制模块控制指令抖动代价。
    在5个速度档（$\SI{3}{m/s}$--$\SI{12}{m/s}$）与同分布/分布外双环境下进行系统评测。
    证据见第3章实验第\ref{sec:ch3_exp}节。

  \item 揭示序列模型端到端控制中的关键陷阱：流式部署状态管理错误导致碰撞率从0\%飙升至90\%；
    提出回合边界级状态生命周期管理协议与硬防护机制。
     系统分析训练模式与推理模式的差异导致的状态错误重置问题；
    设计回合边界级状态管理协议与硬防护机制（运行时断言、配置锁定、可审计日志）。
    证据见第4章实验第\ref{sec:ch4_exp}节。

  \item 探索从混合架构走向全SSM架构：将空间编码器替换为MambaVision，
    量化空间--时间同构建模的可行性与能力边界。
     在保持时序Mamba模块、训练流程与部署一致性机制完全不变的条件下，
    将视觉编码器替换为MambaVision，
    形成空间--时间统一的SSM系列架构。
    证据见第5章实验。

\end{enumerate}

图~\ref{fig:roadmap}给出了本文技术路线总览，
三个阶段分别对应三项创新点。

\begin{figure}[htbp]
\centering
\begin{tikzpicture}[
  >=Stealth,
  node distance=0.6cm and 0.6cm,
  stagebox/.style={
    draw, rounded corners=4pt, minimum width=13.5cm, minimum height=1.8cm,
    text width=13cm, align=left, font=\small, inner sep=8pt
  },
  stagelabel/.style={
    draw, rounded corners=3pt, fill=#1!15, text=#1!80!black,
    font=\bfseries\small, minimum width=1.8cm, minimum height=0.6cm, align=center
  },
  myarrow/.style={->, thick, color=black!60},
]

% === 阶段 A ===
\node[stagebox, fill=blue!5] (boxA) {
  \hspace{2cm}\textbf{端到端系统设计：网络架构 + 训练方法 + 部署约束}\\[2pt]
  \hspace{2cm}ViT 空间编码 $\rightarrow$ Mamba 时序聚合 $\rightarrow$ 控制头\\[1pt]
  \hspace{2cm}BC + DAgger 闭环增强 \,$\vert$\, RACS 部署侧速率限制 \,$\vert$\, 多速度档评测
};
\node[stagelabel=blue, anchor=east] at ($(boxA.west)+(1.6cm,0)$) {阶段 A};

% === 阶段 B ===
\node[stagebox, fill=teal!5, below=of boxA] (boxB) {
  \hspace{2cm}\textbf{流式部署一致性：关键陷阱揭示与状态生命周期管理}\\[2pt]
  \hspace{2cm}训练/推理模式差异 $\rightarrow$ 碰撞率 0\%$\to$90\% 无记忆退化\\[1pt]
  \hspace{2cm}回合边界级状态管理 \,$\vert$\, 硬防护机制 \,$\vert$\, 可审计日志
};
\node[stagelabel=teal, anchor=east] at ($(boxB.west)+(1.6cm,0)$) {阶段 B};

% === 阶段 C ===
\node[stagebox, fill=violet!5, below=of boxB] (boxC) {
  \hspace{2cm}\textbf{全 SSM 架构探索：MambaVision 替换 ViT 视觉编码器}\\[2pt]
  \hspace{2cm}混合 Mamba-Transformer 空间编码 $\rightarrow$ 空间--时间统一 SSM\\[1pt]
  \hspace{2cm}架构同构性 \,$\vert$\, OOD 泛化 \,$\vert$\, 推理效率 \,$\vert$\, 能力边界探索
};
\node[stagelabel=violet, anchor=east] at ($(boxC.west)+(1.6cm,0)$) {阶段 C};

% === 阶段间箭头 ===
\draw[myarrow] (boxA.south) -- (boxB.north);
\draw[myarrow] (boxB.south) -- (boxC.north);

% === 右侧标注 ===
\node[font=\scriptsize\itshape, color=blue!70, anchor=west] at ($(boxA.east)+(0.15,0)$) {创新点1};
\node[font=\scriptsize\itshape, color=teal!70, anchor=west] at ($(boxB.east)+(0.15,0)$) {创新点2};
\node[font=\scriptsize\itshape, color=violet!70, anchor=west] at ($(boxC.east)+(0.15,0)$) {创新点3};

\end{tikzpicture}
\caption{本文技术路线总览}
\label{fig:roadmap}
\end{figure}


\section{论文结构安排}

本文共分五章，
各章内容安排如下：

第1章\quad 绪论。
介绍高速端到端视觉避障的研究背景与应用场景，
通过延迟预算分析量化高速闭环的约束条件，
从误差放大机制与部分可观测性角度阐明时序建模的必要性，
定义核心问题，
分析三项关键挑战并给出可验证命题，
总结本文主要贡献与创新点，
并说明论文结构安排。

第2章\quad 预备知识与相关工作。
综述支撑本文三项创新点的核心背景知识，
包括四旋翼控制接口与低层控制器假设、模仿学习与分布偏移的理论与工程实现、视觉表征（CNN/ViT）的设计空间、时序建模（LSTM/SSM/Mamba）的数学基础与选择性机制、仿真平台与专家策略的完整描述；
同时固定全篇统一的评测协议与指标定义（含统计口径与实现细节），
后续各章实验直接引用。

第3章\quad 面向高速避障的ViT+Mamba端到端策略（创新点一）。
详细介绍ViT+Mamba策略网络的架构设计（含设计选择讨论与复杂度分析）、BC训练与DAgger闭环数据增强（含数据构成分析与收益机制）、RACS部署侧速率限制（含投影推导与边界情况分析），
并在章末给出完整实验结果（ViT+Mamba vs ViT+LSTM主对比、DAgger轮次收敛、RACS安全--平滑权衡、消融实验与失败案例分析）。

第4章\quad 流式部署一致性与状态生命周期管理（创新点二）。
系统分析Batch--Streaming等价性条件（含等价性推导）、状态错误重置导致的无记忆退化机理，
提出回合边界级状态管理协议（含常见工程错误谱系）与硬防护机制（含日志字段规范与等价性单测），
并在章末通过KeepState vs ResetState对比实验与等价性单测定量验证。

第5章\quad 全SSM架构探索与全文总结（创新点三）。
将视觉编码器替换为MambaVision，
在控制变量设计下评测安全性、泛化、延迟与显存四维指标，
讨论适用边界与未来方向；
最后总结全文贡献、讨论局限性并展望未来研究方向。
